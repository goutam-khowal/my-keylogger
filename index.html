<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My Keylogger</title>
  <link rel="shortcut icon" href="key.png" type="image/x-icon">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="min-h-screen bg-slate-900 flex flex-col items-center justify-center gap-8">
  <h1 class="text-center text-4xl font-extrabold tracking-tight text-sky-400 drop-shadow-sm">
    Key Logger
  </h1>

  <div class="flex w-full max-w-md mx-auto justify-center gap-3">
    <button id="startBtn" class="px-5 py-2.5 text-sm font-semibold rounded-xl border border-sky-500/60
           bg-sky-500 text-white shadow-sm shadow-sky-500/40
           transition-all duration-200
           hover:bg-sky-400 hover:border-sky-400 hover:shadow-md hover:shadow-sky-400/40
           focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900
           disabled:opacity-40
           disabled:cursor-not-allowed
           disabled:hover:bg-sky-500 disabled:hover:border-sky-500 disabled:hover:shadow-sm">
      Start Logging Keys
    </button>

    <button id="stopBtn" class="px-5 py-2.5 text-sm font-semibold rounded-xl border border-slate-600
           bg-slate-800 text-slate-100 shadow-sm
           transition-all duration-200
           hover:bg-slate-100 hover:text-slate-900 hover:border-slate-300 hover:shadow-md
           focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900
           disabled:opacity-40
           disabled:cursor-not-allowed
           disabled:hover:bg-slate-800 disabled:hover:text-slate-100 disabled:hover:border-slate-600">
      Stop Logging Keys
    </button>
  </div>

  <div class="w-full max-w-3xl flex flex-col md:flex-row gap-4 px-4">
    <div id="log" class="flex-1 bg-slate-800/70 border border-slate-700 rounded-xl 
           px-4 py-3 text-base font-semibold text-sky-300 h-16
           flex items-center shadow-inner">
    </div>

    <div id="state" class="flex-1 bg-slate-800/70 border border-slate-700 rounded-xl 
           px-4 py-3 text-base font-semibold text-emerald-300 h-16
           flex items-center shadow-inner">
    </div>
  </div>

  <button id="extractBtn" class="mt-2 px-4 py-2 text-sm font-semibold rounded-xl bg-rose-500 text-white
           hover:bg-rose-400 transition-colors disabled:opacity-40 disabled:cursor-not-allowed" disabled>
    Extract Logged Keys
  </button>

  <script>
    const startBtn = document.getElementById("startBtn")
    const stopBtn = document.getElementById("stopBtn")
    const logDiv = document.getElementById("log")
    const stateDiv = document.getElementById("state")
    const extractBtn = document.getElementById("extractBtn")

    const activeKeys = new Set()
    const allCombinations = []

    startBtn.addEventListener("click", () => {
      startBtn.disabled = true
      stopBtn.disabled = false
      extractBtn.disabled = false
      document.addEventListener("keydown", handleDown)
      document.addEventListener("keyup", handleUp)
    })

    stopBtn.addEventListener("click", () => {
      startBtn.disabled = false
      stopBtn.disabled = true
      extractBtn.disabled = false
      document.removeEventListener("keydown", handleDown)
      document.removeEventListener("keyup", handleUp)
      allCombinations.length = 0
    })

    extractBtn.addEventListener("click", extractLoggedKeys)

    function handleDown(e) {
      activeKeys.add(e.key)
      const combo = [...activeKeys].join(" + ")
      logDiv.textContent = `Pressed: ${combo}`
      stateDiv.textContent = `Keys Down: ${combo}`
    }

    function handleUp(e) {
      const combo = [...activeKeys].join(" + ")
      allCombinations.push(`Released: ${e.key} | Down: ${combo}`)
      activeKeys.delete(e.key)

      const remaining = [...activeKeys].join(" + ")
      logDiv.textContent = e.key ? `Released: ${e.key}` : ""
      stateDiv.textContent = remaining ?
        `Keys Down: ${remaining}` :
        "No keys pressed"
    }

    function extractLoggedKeys() {
      if (allCombinations.length == 0) {
        return;
      }
      const text = allCombinations.join("\n")
      const blob = new Blob([text], {
        type: "text/plain"
      })
      const url = URL.createObjectURL(blob)

      const a = document.createElement("a")
      a.href = url
      const d = new Date();
      a.download = `logged-keys-${d.toLocaleDateString()+d.toLocaleTimeString()}.txt`
      document.body.appendChild(a)
      a.click()
      a.remove()
      URL.revokeObjectURL(url)
    }
  </script>
</body>

</html>